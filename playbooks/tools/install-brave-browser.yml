# 20211230
# tested: popos 21.10
# ansible 2.10.8
---

- name: Install brave-browser (apt) # https://brave.com/linux/
  hosts: localhost
  tasks:

  - name: ensure apt-transport-https and curl latest versions installed
    become: true  
    apt:
      pkg:
      - apt-transport-https
      - curl
      state: latest
      update_cache: true

  - name: Get keyring file
    become: true
    ansible.builtin.get_url:
      url: https://brave-browser-apt-release.s3.brave.com/brave-browser-archive-keyring.gpg
      dest: "/usr/share/keyrings/brave-browser-archive-keyring.gpg"


  - name: Add Brave repository to list of repositories
    ansible.builtin.shell: |
      set -o pipefail
      echo 'deb [signed-by=/usr/share/keyrings/brave-browser-archive-keyring.gpg arch=amd64] https://brave-browser-apt-release.s3.brave.com/ stable main' |sudo tee -a /etc/apt/sources.list.d/brave-browser-release.list
    args:
      executable: /bin/bash

  - name: ensure brave-browser latest version installed
    become: true  
    apt:
      name: brave-browser
      state: latest
      update_cache: true

  #TODO: install extensions